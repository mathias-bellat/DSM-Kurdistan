<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Fourier-transform infrared spectroscopy of soil samples | Soil information in Kurdistan region, Dohuk governorate (Iraq), supplementary material</title>
  <meta name="description" content="The complete worklow for the process of soil informations mapping in Dohuk province of the autonomous region of Kurdistan in Iraq." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Fourier-transform infrared spectroscopy of soil samples | Soil information in Kurdistan region, Dohuk governorate (Iraq), supplementary material" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/LOGO.png" />
  <meta property="og:description" content="The complete worklow for the process of soil informations mapping in Dohuk province of the autonomous region of Kurdistan in Iraq." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Fourier-transform infrared spectroscopy of soil samples | Soil information in Kurdistan region, Dohuk governorate (Iraq), supplementary material" />
  
  <meta name="twitter:description" content="The complete worklow for the process of soil informations mapping in Dohuk province of the autonomous region of Kurdistan in Iraq." />
  <meta name="twitter:image" content="/images/LOGO.png" />

<meta name="author" content="Mathias Bellat" />


<meta name="date" content="2025-03-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Field.html"/>
<link rel="next" href="laboratory-measurement-of-the-selected-soil-samples.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="RUSLE.html"><a href="RUSLE.html"><i class="fa fa-check"></i><b>1</b> RUSLE model protocol</a>
<ul>
<li class="chapter" data-level="1.1" data-path="RUSLE.html"><a href="RUSLE.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="RUSLE.html"><a href="RUSLE.html#purpose"><i class="fa fa-check"></i><b>1.1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.1.2" data-path="RUSLE.html"><a href="RUSLE.html#procedure"><i class="fa fa-check"></i><b>1.1.2</b> Procedure</a></li>
<li class="chapter" data-level="1.1.3" data-path="RUSLE.html"><a href="RUSLE.html#input-data"><i class="fa fa-check"></i><b>1.1.3</b> Input data</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="RUSLE.html"><a href="RUSLE.html#equations"><i class="fa fa-check"></i><b>1.2</b> Equations</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="RUSLE.html"><a href="RUSLE.html#r-factor"><i class="fa fa-check"></i><b>1.2.1</b> R Factor</a></li>
<li class="chapter" data-level="1.2.2" data-path="RUSLE.html"><a href="RUSLE.html#k-factor"><i class="fa fa-check"></i><b>1.2.2</b> K Factor</a></li>
<li class="chapter" data-level="1.2.3" data-path="RUSLE.html"><a href="RUSLE.html#ls-factor"><i class="fa fa-check"></i><b>1.2.3</b> LS factor</a></li>
<li class="chapter" data-level="1.2.4" data-path="RUSLE.html"><a href="RUSLE.html#c-factor"><i class="fa fa-check"></i><b>1.2.4</b> C factor</a></li>
<li class="chapter" data-level="1.2.5" data-path="RUSLE.html"><a href="RUSLE.html#p-factor"><i class="fa fa-check"></i><b>1.2.5</b> P factor</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="RUSLE.html"><a href="RUSLE.html#results"><i class="fa fa-check"></i><b>1.3</b> Results</a></li>
<li class="chapter" data-level="1.4" data-path="RUSLE.html"><a href="RUSLE.html#annexes"><i class="fa fa-check"></i><b>1.4</b> Annexes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="CLHS.html"><a href="CLHS.html"><i class="fa fa-check"></i><b>2</b> Conditioned Latin hypercube sampling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="CLHS.html"><a href="CLHS.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="CLHS.html"><a href="CLHS.html#purpose-1"><i class="fa fa-check"></i><b>2.1.1</b> Purpose</a></li>
<li class="chapter" data-level="2.1.2" data-path="CLHS.html"><a href="CLHS.html#procedure-1"><i class="fa fa-check"></i><b>2.1.2</b> Procedure</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="CLHS.html"><a href="CLHS.html#data-treatement"><i class="fa fa-check"></i><b>2.2</b> Data treatement</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="CLHS.html"><a href="CLHS.html#soil-prediction-map-nafiseh-kakhani"><i class="fa fa-check"></i><b>2.2.1</b> Soil prediction map (Nafiseh Kakhani)</a></li>
<li class="chapter" data-level="2.2.2" data-path="CLHS.html"><a href="CLHS.html#soil-erosion-based-on-rusle-model"><i class="fa fa-check"></i><b>2.2.2</b> Soil erosion based on RUSLE model</a></li>
<li class="chapter" data-level="2.2.3" data-path="CLHS.html"><a href="CLHS.html#Slope"><i class="fa fa-check"></i><b>2.2.3</b> DEM, slope and topographic wetness index</a></li>
<li class="chapter" data-level="2.2.4" data-path="CLHS.html"><a href="CLHS.html#geomorphological-map"><i class="fa fa-check"></i><b>2.2.4</b> Geomorphological map</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="CLHS.html"><a href="CLHS.html#conditioned-latin-hypercube-sampling-script"><i class="fa fa-check"></i><b>2.3</b> conditioned Latin hypercube sampling script</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="CLHS.html"><a href="CLHS.html#preparation-of-the-r-environement"><i class="fa fa-check"></i><b>2.3.1</b> Preparation of the R environement</a></li>
<li class="chapter" data-level="2.3.2" data-path="CLHS.html"><a href="CLHS.html#preparation-of-the-data"><i class="fa fa-check"></i><b>2.3.2</b> Preparation of the data</a></li>
<li class="chapter" data-level="2.3.3" data-path="CLHS.html"><a href="CLHS.html#calculation-of-the-conditioned-latin-hypercube-sampling"><i class="fa fa-check"></i><b>2.3.3</b> Calculation of the conditioned Latin hypercube sampling</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="CLHS.html"><a href="CLHS.html#sampling-locations"><i class="fa fa-check"></i><b>2.4</b> Sampling locations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Field.html"><a href="Field.html"><i class="fa fa-check"></i><b>3</b> Field information and sampling locations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Field.html"><a href="Field.html#sites-sampled"><i class="fa fa-check"></i><b>3.1</b> Sites sampled</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="Field.html"><a href="Field.html#and-2018-campaigns"><i class="fa fa-check"></i><b>3.1.1</b> 2017 and 2018 campaigns</a></li>
<li class="chapter" data-level="3.1.2" data-path="Field.html"><a href="Field.html#and-2023-campaigns"><i class="fa fa-check"></i><b>3.1.2</b> 2022 and 2023 campaigns</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Field.html"><a href="Field.html#regional-information-and-collected-data"><i class="fa fa-check"></i><b>3.2</b> Regional information and collected data</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="Field.html"><a href="Field.html#landscape-observations"><i class="fa fa-check"></i><b>3.2.1</b> Landscape observations</a></li>
<li class="chapter" data-level="3.2.2" data-path="Field.html"><a href="Field.html#sampling-method"><i class="fa fa-check"></i><b>3.2.2</b> Sampling method</a></li>
<li class="chapter" data-level="3.2.3" data-path="Field.html"><a href="Field.html#collected-informations"><i class="fa fa-check"></i><b>3.2.3</b> Collected informations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="FTIR.html"><a href="FTIR.html"><i class="fa fa-check"></i><b>4</b> Fourier-transform infrared spectroscopy of soil samples</a>
<ul>
<li class="chapter" data-level="4.1" data-path="FTIR.html"><a href="FTIR.html#protocol-and-devices"><i class="fa fa-check"></i><b>4.1</b> Protocol and devices</a></li>
<li class="chapter" data-level="4.2" data-path="FTIR.html"><a href="FTIR.html#raw-spectra-production"><i class="fa fa-check"></i><b>4.2</b> Raw spectra production</a></li>
<li class="chapter" data-level="4.3" data-path="FTIR.html"><a href="FTIR.html#prepare-the-spectra-regarding-state-of-the-art"><i class="fa fa-check"></i><b>4.3</b> Prepare the spectra regarding state of the art</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="FTIR.html"><a href="FTIR.html#interval-interferances"><i class="fa fa-check"></i><b>4.3.1</b> Interval interferances</a></li>
<li class="chapter" data-level="4.3.2" data-path="FTIR.html"><a href="FTIR.html#outlier-values"><i class="fa fa-check"></i><b>4.3.2</b> Outlier values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="FTIR.html"><a href="FTIR.html#convert-into-different-spectra-variation"><i class="fa fa-check"></i><b>4.4</b> Convert into different spectra variation</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="FTIR.html"><a href="FTIR.html#convert-into-wavelength"><i class="fa fa-check"></i><b>4.4.1</b> Convert into wavelength</a></li>
<li class="chapter" data-level="4.4.2" data-path="FTIR.html"><a href="FTIR.html#spectra-transformations"><i class="fa fa-check"></i><b>4.4.2</b> Spectra transformations</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="FTIR.html"><a href="FTIR.html#plot-the-spectra"><i class="fa fa-check"></i><b>4.5</b> Plot the spectra</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="FTIR.html"><a href="FTIR.html#the-spectra-in-absorbance"><i class="fa fa-check"></i><b>4.5.1</b> The spectra in absorbance</a></li>
<li class="chapter" data-level="4.5.2" data-path="FTIR.html"><a href="FTIR.html#the-spectra-in-reflectance"><i class="fa fa-check"></i><b>4.5.2</b> The spectra in reflectance</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="FTIR.html"><a href="FTIR.html#kennard-stone-sampling"><i class="fa fa-check"></i><b>4.6</b> Kennard Stone sampling</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="laboratory-measurement-of-the-selected-soil-samples.html"><a href="laboratory-measurement-of-the-selected-soil-samples.html"><i class="fa fa-check"></i><b>5</b> Laboratory measurement of the selected soil samples</a>
<ul>
<li class="chapter" data-level="5.1" data-path="laboratory-measurement-of-the-selected-soil-samples.html"><a href="laboratory-measurement-of-the-selected-soil-samples.html#protocol"><i class="fa fa-check"></i><b>5.1</b> Protocol</a></li>
<li class="chapter" data-level="5.2" data-path="laboratory-measurement-of-the-selected-soil-samples.html"><a href="laboratory-measurement-of-the-selected-soil-samples.html#properties"><i class="fa fa-check"></i><b>5.2</b> Properties</a></li>
<li class="chapter" data-level="5.3" data-path="laboratory-measurement-of-the-selected-soil-samples.html"><a href="laboratory-measurement-of-the-selected-soil-samples.html#non-mesured-samples"><i class="fa fa-check"></i><b>5.3</b> Non mesured samples</a></li>
<li class="chapter" data-level="5.4" data-path="laboratory-measurement-of-the-selected-soil-samples.html"><a href="laboratory-measurement-of-the-selected-soil-samples.html#texture-mesurment"><i class="fa fa-check"></i><b>5.4</b> Texture mesurment</a></li>
<li class="chapter" data-level="5.5" data-path="laboratory-measurement-of-the-selected-soil-samples.html"><a href="laboratory-measurement-of-the-selected-soil-samples.html#table-of-the-mesured-samples"><i class="fa fa-check"></i><b>5.5</b> Table of the mesured samples</a></li>
<li class="chapter" data-level="5.6" data-path="laboratory-measurement-of-the-selected-soil-samples.html"><a href="laboratory-measurement-of-the-selected-soil-samples.html#properties-of-the-measured-samples"><i class="fa fa-check"></i><b>5.6</b> Properties of the measured samples</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Spectrapred.html"><a href="Spectrapred.html"><i class="fa fa-check"></i><b>6</b> Spectra model prediction</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Spectrapred.html"><a href="Spectrapred.html#model-implementation"><i class="fa fa-check"></i><b>6.1</b> Model implementation</a></li>
<li class="chapter" data-level="6.2" data-path="Spectrapred.html"><a href="Spectrapred.html#model-evaluation"><i class="fa fa-check"></i><b>6.2</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="Spectrapred.html"><a href="Spectrapred.html#all-spectra-tranformations-metrics"><i class="fa fa-check"></i><b>6.2.1</b> All spectra tranformations metrics</a></li>
<li class="chapter" data-level="6.2.2" data-path="Spectrapred.html"><a href="Spectrapred.html#selected-transformed-spectra"><i class="fa fa-check"></i><b>6.2.2</b> Selected transformed spectra</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="Spectrapred.html"><a href="Spectrapred.html#predicted-values"><i class="fa fa-check"></i><b>6.3</b> Predicted values</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="Spectrapred.html"><a href="Spectrapred.html#full-predicted-values-table"><i class="fa fa-check"></i><b>6.3.1</b> Full predicted values table</a></li>
<li class="chapter" data-level="6.3.2" data-path="Spectrapred.html"><a href="Spectrapred.html#boxplot-of-the-predicted-values"><i class="fa fa-check"></i><b>6.3.2</b> Boxplot of the predicted values</a></li>
<li class="chapter" data-level="6.3.3" data-path="Spectrapred.html"><a href="Spectrapred.html#texture-of-the-predicted-samples"><i class="fa fa-check"></i><b>6.3.3</b> Texture of the predicted samples</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="Spectrapred.html"><a href="Spectrapred.html#spatial-ploting"><i class="fa fa-check"></i><b>6.4</b> Spatial ploting</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="Spectrapred.html"><a href="Spectrapred.html#cm-depth"><i class="fa fa-check"></i><b>6.4.1</b> 0 - 10 cm depth</a></li>
<li class="chapter" data-level="6.4.2" data-path="Spectrapred.html"><a href="Spectrapred.html#cm-depth-1"><i class="fa fa-check"></i><b>6.4.2</b> 10 - 30 cm depth</a></li>
<li class="chapter" data-level="6.4.3" data-path="Spectrapred.html"><a href="Spectrapred.html#cm-depth-2"><i class="fa fa-check"></i><b>6.4.3</b> 30 - 50 cm depth</a></li>
<li class="chapter" data-level="6.4.4" data-path="Spectrapred.html"><a href="Spectrapred.html#cm-depth-3"><i class="fa fa-check"></i><b>6.4.4</b> 50 - 70 cm depth</a></li>
<li class="chapter" data-level="6.4.5" data-path="Spectrapred.html"><a href="Spectrapred.html#cm-depth-4"><i class="fa fa-check"></i><b>6.4.5</b> 70 - 100 cm depth</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html"><i class="fa fa-check"></i><b>7</b> Digital soil mapping</a>
<ul>
<li class="chapter" data-level="7.1" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#purpose-2"><i class="fa fa-check"></i><b>7.1.1</b> Purpose</a></li>
<li class="chapter" data-level="7.1.2" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#covariates"><i class="fa fa-check"></i><b>7.1.2</b> Covariates</a></li>
<li class="chapter" data-level="7.1.3" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#soil-properties"><i class="fa fa-check"></i><b>7.1.3</b> Soil properties</a></li>
<li class="chapter" data-level="7.1.4" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#preparation-of-the-data-1"><i class="fa fa-check"></i><b>7.1.4</b> Preparation of the data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#soil-depth-mapping-preparation"><i class="fa fa-check"></i><b>7.2</b> Soil depth mapping preparation</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#preparation-of-the-environment"><i class="fa fa-check"></i><b>7.2.1</b> Preparation of the environment</a></li>
<li class="chapter" data-level="7.2.2" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#prepare-the-data"><i class="fa fa-check"></i><b>7.2.2</b> Prepare the data</a></li>
<li class="chapter" data-level="7.2.3" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#prepare-the-covariates"><i class="fa fa-check"></i><b>7.2.3</b> Prepare the covariates</a></li>
<li class="chapter" data-level="7.2.4" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#run-the-first-models"><i class="fa fa-check"></i><b>7.2.4</b> Run the first models</a></li>
<li class="chapter" data-level="7.2.5" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#boruta-and-rfe-selections"><i class="fa fa-check"></i><b>7.2.5</b> Boruta and RFE selections</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#models-developpment"><i class="fa fa-check"></i><b>7.3</b> Models developpment</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#preparation-of-the-environment-1"><i class="fa fa-check"></i><b>7.3.1</b> Preparation of the environment</a></li>
<li class="chapter" data-level="7.3.2" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#tune-the-model"><i class="fa fa-check"></i><b>7.3.2</b> Tune the model</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#model-evaluation-1"><i class="fa fa-check"></i><b>7.4</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#preparation-of-the-environment-2"><i class="fa fa-check"></i><b>7.4.1</b> Preparation of the environment</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#prediction-of-the-area"><i class="fa fa-check"></i><b>7.5</b> Prediction of the area</a></li>
<li class="chapter" data-level="7.6" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#visualisation-and-comparison-with-soilgrid-product"><i class="fa fa-check"></i><b>7.6</b> Visualisation and comparison with SoilGrid product</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#preparation-of-the-environment-3"><i class="fa fa-check"></i><b>7.6.1</b> Preparation of the environment</a></li>
<li class="chapter" data-level="7.6.2" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#visualisation-of-the-final-products"><i class="fa fa-check"></i><b>7.6.2</b> Visualisation of the final products</a></li>
<li class="chapter" data-level="7.6.3" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#soilgrid-evaluation"><i class="fa fa-check"></i><b>7.6.3</b> SoilGrid evaluation</a></li>
<li class="chapter" data-level="7.6.4" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#bivariate-and-density-plot-of-the-two-predictions"><i class="fa fa-check"></i><b>7.6.4</b> Bivariate and density plot of the two predictions</a></li>
<li class="chapter" data-level="7.6.5" data-path="digital-soil-mapping.html"><a href="digital-soil-mapping.html#selection-between-our-predictions-and-soilgrid-model"><i class="fa fa-check"></i><b>7.6.5</b> Selection between our predictions and SoilGrid model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html"><i class="fa fa-check"></i><b>8</b> Soil depth mapping</a>
<ul>
<li class="chapter" data-level="8.1" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#introduction-3"><i class="fa fa-check"></i><b>8.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#purpose-3"><i class="fa fa-check"></i><b>8.1.1</b> Purpose</a></li>
<li class="chapter" data-level="8.1.2" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#covariates-1"><i class="fa fa-check"></i><b>8.1.2</b> Covariates</a></li>
<li class="chapter" data-level="8.1.3" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#soil-depths"><i class="fa fa-check"></i><b>8.1.3</b> Soil depths</a></li>
<li class="chapter" data-level="8.1.4" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#preparation-of-the-data-2"><i class="fa fa-check"></i><b>8.1.4</b> Preparation of the data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#soil-depth-mapping-prediction"><i class="fa fa-check"></i><b>8.2</b> Soil depth mapping prediction</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#preparation-of-the-environment-4"><i class="fa fa-check"></i><b>8.2.1</b> Preparation of the environment</a></li>
<li class="chapter" data-level="8.2.2" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#prepare-the-data-1"><i class="fa fa-check"></i><b>8.2.2</b> Prepare the data</a></li>
<li class="chapter" data-level="8.2.3" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#tune-the-model-1"><i class="fa fa-check"></i><b>8.2.3</b> Tune the model</a></li>
<li class="chapter" data-level="8.2.4" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#final-model"><i class="fa fa-check"></i><b>8.2.4</b> Final model</a></li>
<li class="chapter" data-level="8.2.5" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#model-evaluation-2"><i class="fa fa-check"></i><b>8.2.5</b> Model evaluation</a></li>
<li class="chapter" data-level="8.2.6" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#mapping-the-soil-depth-of-the-area"><i class="fa fa-check"></i><b>8.2.6</b> Mapping the soil depth of the area</a></li>
<li class="chapter" data-level="8.2.7" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#prediction-of-uncertainty-map"><i class="fa fa-check"></i><b>8.2.7</b> Prediction of uncertainty map</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#visualisations-and-exports"><i class="fa fa-check"></i><b>8.3</b> Visualisations and exports</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#basic-visualisations"><i class="fa fa-check"></i><b>8.3.1</b> Basic visualisations</a></li>
<li class="chapter" data-level="8.3.2" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#colorblind-visualisations"><i class="fa fa-check"></i><b>8.3.2</b> Colorblind visualisations</a></li>
<li class="chapter" data-level="8.3.3" data-path="soil-depth-mapping.html"><a href="soil-depth-mapping.html#export-final-maps"><i class="fa fa-check"></i><b>8.3.3</b> Export final maps</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Soil information in Kurdistan region, Dohuk governorate (Iraq), supplementary material</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="FTIR" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Fourier-transform infrared spectroscopy of soil samples<a href="FTIR.html#FTIR" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="protocol-and-devices" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Protocol and devices<a href="FTIR.html#protocol-and-devices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We analysed all of our <strong>29</strong> samples from 2017-2018 campaigns and <strong>532</strong> from 2022-2023 campaigns with mid-infrared spectroscopy to serve as predictors for the prediction model on the soil properties. These techniques are now well knowned and commonly used in soil science as they allow spare time and money on the different laboratory measurements <span class="citation">(<a href="#ref-wadoux_soil_2021">Wadoux et al. 2021</a>; <a href="#ref-viscarra_rossel_global_2016">Viscarra Rossel et al. 2016</a>; <a href="#ref-ng_near_2022">Ng et al. 2022</a>; <a href="#ref-ge_primer_2022">Ge, Wadoux, and Peng 2022</a>; <a href="#ref-stenberg_visible_2010">Stenberg et al. 2010</a>; <a href="#ref-bahrami_studying_2022">Bahrami, Danesh, and Bahrami 2022</a>)</span>.</p>
<p>Before being analysed with FTIR the samples were ground under 1 µm with a <em>Pulverisette 5/4, classic line</em> (Fritsh, Idar-Oberstein, Germany) in a <strong>250 ml</strong> stainless steel hardness container (ISO: X105CrMo17) with <strong>five</strong> 20 mm sintered corrodium (99.7 % Al<sub>2</sub>O<sub>3</sub>) grinding balls. The settings were set at 350 turns per minute for 12 minutes in total.</p>
<p>The last step before FTIR analyse was to realise lenses from the samples with KBr pressling method. 250 mg of potassium brodime (KBr) and 1-1.3 mg of sample substance are mixed and then loaded in a hydraulic press under vacuum with around 10 - 11 tonnes and pressed for 1-2 minutes to form a transparent tablet, e.g. 10 mm in diameter and 1 mm thick.</p>
<p>This tablet was analysed under mid-infrared Fourier-transform spectroscopy with a <em>Vertex 80v</em> (Bruker OPTIK GmbH; Germany) under a control environment. The measurement resolution is 4 cm<sup>-1</sup> in the interval of 375 - 4500 cm <sup>-1</sup>, the spectrum is in absorbance and the source is MIR with the optic filter. To calibrate these samples, one control tablet made of 100% of KBr was measured at the beginning of each measurement session.</p>
</div>
<div id="raw-spectra-production" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Raw spectra production<a href="FTIR.html#raw-spectra-production" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A script was written to produce a raw spectra in absorbance for 375 - 4500 cm <sup>-1</sup> interval with a 4 cm<sup>-1</sup> resolution and export it under a .txt format.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="FTIR.html#cb1-1" tabindex="-1"></a><span class="co"># 0 Environment setup ##########################################################</span></span>
<span id="cb1-2"><a href="FTIR.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="FTIR.html#cb1-3" tabindex="-1"></a><span class="co"># 0.1 Prepare environment ======================================================</span></span>
<span id="cb1-4"><a href="FTIR.html#cb1-4" tabindex="-1"></a><span class="co"># Folder check</span></span>
<span id="cb1-5"><a href="FTIR.html#cb1-5" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb1-6"><a href="FTIR.html#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="FTIR.html#cb1-7" tabindex="-1"></a><span class="co"># Select folder</span></span>
<span id="cb1-8"><a href="FTIR.html#cb1-8" tabindex="-1"></a><span class="fu">setwd</span>(<span class="fu">getwd</span>())</span>
<span id="cb1-9"><a href="FTIR.html#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="FTIR.html#cb1-10" tabindex="-1"></a><span class="co"># Clean up workspace</span></span>
<span id="cb1-11"><a href="FTIR.html#cb1-11" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>(<span class="at">all.names =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-12"><a href="FTIR.html#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="FTIR.html#cb1-13" tabindex="-1"></a><span class="co"># 0.2 Install packages =========================================================</span></span>
<span id="cb1-14"><a href="FTIR.html#cb1-14" tabindex="-1"></a></span>
<span id="cb1-15"><a href="FTIR.html#cb1-15" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb1-16"><a href="FTIR.html#cb1-16" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;pacman&quot;</span>)  <span class="co">#Install and load the &quot;pacman&quot; package (allow easier download of packages)</span></span>
<span id="cb1-17"><a href="FTIR.html#cb1-17" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb1-18"><a href="FTIR.html#cb1-18" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(prospectr, remotes, caret , dplyr, readr)   <span class="do">### Install required packages</span></span>
<span id="cb1-19"><a href="FTIR.html#cb1-19" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;philipp-baumann/simplerspec&quot;</span>) <span class="co">#Install package from Baumann for spectral analysis</span></span>
<span id="cb1-20"><a href="FTIR.html#cb1-20" tabindex="-1"></a><span class="fu">library</span>(simplerspec)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="FTIR.html#cb2-1" tabindex="-1"></a><span class="co"># 0.3 Show session infos =======================================================</span></span>
<span id="cb2-2"><a href="FTIR.html#cb2-2" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.4.0 (2024-04-24 ucrt)
## Platform: x86_64-w64-mingw32/x64
## Running under: Windows 11 x64 (build 22621)
## 
## Matrix products: default
## 
## 
## locale:
## [1] LC_COLLATE=French_France.utf8  LC_CTYPE=French_France.utf8   
## [3] LC_MONETARY=French_France.utf8 LC_NUMERIC=C                  
## [5] LC_TIME=French_France.utf8    
## 
## time zone: Asia/Tbilisi
## tzcode source: internal
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] simplerspec_0.2.1 foreach_1.5.2     dplyr_1.1.4       caret_6.0-94     
## [5] lattice_0.22-6    ggplot2_3.5.1     readr_2.1.5       remotes_2.5.0    
## [9] prospectr_0.2.7  
## 
## loaded via a namespace (and not attached):
##  [1] gtable_0.3.6         xfun_0.46            bslib_0.8.0         
##  [4] recipes_1.1.0        mathjaxr_1.6-0       tzdb_0.4.0          
##  [7] vctrs_0.6.5          tools_4.4.0          generics_0.1.3      
## [10] curl_5.2.1           stats4_4.4.0         parallel_4.4.0      
## [13] proxy_0.4-27         tibble_3.2.1         fansi_1.0.6         
## [16] ModelMetrics_1.2.2.2 pkgconfig_2.0.3      Matrix_1.7-0        
## [19] data.table_1.15.4    lifecycle_1.0.4      stringr_1.5.1       
## [22] compiler_4.4.0       munsell_0.5.1        codetools_0.2-20    
## [25] htmltools_0.5.8.1    class_7.3-22         sass_0.4.9          
## [28] yaml_2.3.10          prodlim_2024.06.25   pillar_1.9.0        
## [31] jquerylib_0.1.4      MASS_7.3-60.2        cachem_1.1.0        
## [34] gower_1.0.1          iterators_1.0.14     rpart_4.1.23        
## [37] nlme_3.1-164         parallelly_1.38.0    lava_1.8.0          
## [40] tidyselect_1.2.1     digest_0.6.36        stringi_1.8.4       
## [43] future_1.34.0        reshape2_1.4.4       purrr_1.0.2         
## [46] bookdown_0.40        listenv_0.9.1        splines_4.4.0       
## [49] fastmap_1.2.0        grid_4.4.0           colorspace_2.1-1    
## [52] cli_3.6.3            magrittr_2.0.3       survival_3.5-8      
## [55] utf8_1.2.4           e1071_1.7-14         future.apply_1.11.2 
## [58] withr_3.0.2          scales_1.3.0         lubridate_1.9.3     
## [61] timechange_0.3.0     rmarkdown_2.27       globals_0.16.3      
## [64] nnet_7.3-19          timeDate_4032.109    hms_1.1.3           
## [67] evaluate_0.24.0      knitr_1.48           hardhat_1.4.0       
## [70] rlang_1.1.4          Rcpp_1.0.13          glue_1.7.0          
## [73] pROC_1.18.5          ipred_0.9-15         rstudioapi_0.16.0   
## [76] jsonlite_1.8.8       R6_2.5.1             plyr_1.8.9</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="FTIR.html#cb4-1" tabindex="-1"></a><span class="co"># 01 Prepare and import data ---------------------------------------------------</span></span>
<span id="cb4-2"><a href="FTIR.html#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="FTIR.html#cb4-3" tabindex="-1"></a><span class="co"># 01.1 Import the raw spectra files ############################################</span></span>
<span id="cb4-4"><a href="FTIR.html#cb4-4" tabindex="-1"></a>lfMIR <span class="ot">&lt;-</span> <span class="fu">read_opus_univ</span>(<span class="at">fnames =</span> <span class="fu">dir</span>(<span class="st">&quot;./data/spectra/&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>), <span class="at">extract =</span> <span class="fu">c</span>(<span class="st">&quot;spc&quot;</span>))</span>
<span id="cb4-5"><a href="FTIR.html#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="FTIR.html#cb4-6" tabindex="-1"></a><span class="co"># 01.2 Preparing the MIR Data ##################################################</span></span>
<span id="cb4-7"><a href="FTIR.html#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="FTIR.html#cb4-8" tabindex="-1"></a>MIRspec_tbl <span class="ot">&lt;-</span> lfMIR <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="FTIR.html#cb4-9" tabindex="-1"></a>  <span class="fu">gather_spc</span>() <span class="sc">%&gt;%</span>    <span class="co"># Gather list of spectra data into tibble data frame</span></span>
<span id="cb4-10"><a href="FTIR.html#cb4-10" tabindex="-1"></a>  <span class="fu">resample_spc</span>(<span class="at">wn_lower =</span> <span class="dv">375</span>, <span class="at">wn_upper =</span> <span class="dv">4500</span>, <span class="at">wn_interval =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span>     <span class="co"># Resample spectra to new wavenumber interval</span></span>
<span id="cb4-11"><a href="FTIR.html#cb4-11" tabindex="-1"></a>  <span class="fu">average_spc</span>(<span class="at">by =</span> <span class="st">&quot;sample_id&quot;</span>) <span class="co"># Average replicate scans per sample_id</span></span>
<span id="cb4-12"><a href="FTIR.html#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="FTIR.html#cb4-13" tabindex="-1"></a>MIRspec_tbl_rs <span class="ot">&lt;-</span> MIRspec_tbl[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(MIRspec_tbl)), <span class="fu">c</span>(<span class="st">&quot;sample_id&quot;</span>, <span class="st">&quot;metadata&quot;</span>, <span class="st">&quot;wavenumbers_rs&quot;</span>, <span class="st">&quot;spc_mean&quot;</span>)]</span>
<span id="cb4-14"><a href="FTIR.html#cb4-14" tabindex="-1"></a>MIRspec_tbl_rs <span class="ot">&lt;-</span> MIRspec_tbl_rs[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]  </span>
<span id="cb4-15"><a href="FTIR.html#cb4-15" tabindex="-1"></a></span>
<span id="cb4-16"><a href="FTIR.html#cb4-16" tabindex="-1"></a><span class="co"># Create a data frame and change the columns names</span></span>
<span id="cb4-17"><a href="FTIR.html#cb4-17" tabindex="-1"></a>MIRspec_wn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(MIRspec_tbl_rs<span class="sc">$</span>spc_mean), <span class="at">nrow =</span> <span class="fu">nrow</span>(MIRspec_tbl_rs), <span class="at">byrow =</span> <span class="cn">TRUE</span>), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-18"><a href="FTIR.html#cb4-18" tabindex="-1"></a><span class="fu">rownames</span>(MIRspec_wn) <span class="ot">&lt;-</span> <span class="fu">substring</span>(MIRspec_tbl<span class="sc">$</span>sample_id, <span class="dv">1</span>)[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(MIRspec_tbl))]</span>
<span id="cb4-19"><a href="FTIR.html#cb4-19" tabindex="-1"></a>wn <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">names</span>(MIRspec_tbl_rs[[<span class="dv">2</span>]][[<span class="dv">1</span>]]))</span>
<span id="cb4-20"><a href="FTIR.html#cb4-20" tabindex="-1"></a>wn <span class="ot">&lt;-</span> <span class="fu">unlist</span>(wn)</span>
<span id="cb4-21"><a href="FTIR.html#cb4-21" tabindex="-1"></a><span class="fu">names</span>(MIRspec_wn) <span class="ot">&lt;-</span> wn</span>
<span id="cb4-22"><a href="FTIR.html#cb4-22" tabindex="-1"></a>MIRspec_wn <span class="ot">&lt;-</span> MIRspec_wn[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>)] <span class="co"># Remove NA values from the 4499  cm-1</span></span>
<span id="cb4-23"><a href="FTIR.html#cb4-23" tabindex="-1"></a></span>
<span id="cb4-24"><a href="FTIR.html#cb4-24" tabindex="-1"></a><span class="co"># 01.3 Export the MIR raw data #################################################</span></span>
<span id="cb4-25"><a href="FTIR.html#cb4-25" tabindex="-1"></a><span class="fu">write.table</span>(MIRspec_wn, <span class="st">&quot;./export/spectra/Spectra_raw_Wavenumber.txt&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">col.names =</span> <span class="cn">TRUE</span>, <span class="at">append =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="prepare-the-spectra-regarding-state-of-the-art" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Prepare the spectra regarding state of the art<a href="FTIR.html#prepare-the-spectra-regarding-state-of-the-art" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="interval-interferances" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Interval interferances<a href="FTIR.html#interval-interferances" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The MIR spectra present interference in different intervals such as 375 - 499 cm<sup>-1</sup> area and 2451 - 2500 cm <sup>-1</sup> area <span class="citation">(<a href="#ref-ng_search_2018">Ng et al. 2018</a>)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="FTIR.html#cb5-1" tabindex="-1"></a><span class="co"># 02 Prepare the spectra regarding the state of the art ------------------------</span></span>
<span id="cb5-2"><a href="FTIR.html#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="FTIR.html#cb5-3" tabindex="-1"></a><span class="co"># 2.1 First cleaning of the spectra ============================================</span></span>
<span id="cb5-4"><a href="FTIR.html#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="FTIR.html#cb5-5" tabindex="-1"></a>MIRspec_tbl <span class="ot">&lt;-</span> lfMIR <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="FTIR.html#cb5-6" tabindex="-1"></a>  <span class="fu">gather_spc</span>() <span class="sc">%&gt;%</span>    <span class="co"># Gather list of spectra data into tibble data frame</span></span>
<span id="cb5-7"><a href="FTIR.html#cb5-7" tabindex="-1"></a>  <span class="fu">resample_spc</span>(<span class="at">wn_lower =</span> <span class="dv">499</span>, <span class="at">wn_upper =</span> <span class="dv">4500</span>, <span class="at">wn_interval =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span>     <span class="co"># Resample spectra to new wavenumber interval</span></span>
<span id="cb5-8"><a href="FTIR.html#cb5-8" tabindex="-1"></a>  <span class="fu">average_spc</span>(<span class="at">by =</span> <span class="st">&quot;sample_id&quot;</span>) <span class="co"># Average replicate scans per sample_id</span></span>
<span id="cb5-9"><a href="FTIR.html#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="FTIR.html#cb5-10" tabindex="-1"></a>MIRspec_tbl_rs <span class="ot">&lt;-</span> MIRspec_tbl[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(MIRspec_tbl)), <span class="fu">c</span>(<span class="st">&quot;sample_id&quot;</span>, <span class="st">&quot;metadata&quot;</span>, <span class="st">&quot;wavenumbers_rs&quot;</span>, <span class="st">&quot;spc_mean&quot;</span>)]</span>
<span id="cb5-11"><a href="FTIR.html#cb5-11" tabindex="-1"></a>MIRspec_tbl_rs <span class="ot">&lt;-</span> MIRspec_tbl_rs[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]  </span>
<span id="cb5-12"><a href="FTIR.html#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="FTIR.html#cb5-13" tabindex="-1"></a><span class="co"># Create a data frame and change the columns names</span></span>
<span id="cb5-14"><a href="FTIR.html#cb5-14" tabindex="-1"></a>MIRspec_wn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">unlist</span>(MIRspec_tbl_rs<span class="sc">$</span>spc_mean), <span class="at">nrow =</span> <span class="fu">nrow</span>(MIRspec_tbl_rs), <span class="at">byrow =</span> <span class="cn">TRUE</span>), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-15"><a href="FTIR.html#cb5-15" tabindex="-1"></a><span class="fu">rownames</span>(MIRspec_wn) <span class="ot">&lt;-</span> <span class="fu">substring</span>(MIRspec_tbl<span class="sc">$</span>sample_id, <span class="dv">1</span>)[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(MIRspec_tbl))]</span>
<span id="cb5-16"><a href="FTIR.html#cb5-16" tabindex="-1"></a>wn <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">names</span>(MIRspec_tbl_rs[[<span class="dv">2</span>]][[<span class="dv">1</span>]]))</span>
<span id="cb5-17"><a href="FTIR.html#cb5-17" tabindex="-1"></a>wn <span class="ot">&lt;-</span> <span class="fu">unlist</span>(wn)</span>
<span id="cb5-18"><a href="FTIR.html#cb5-18" tabindex="-1"></a><span class="fu">names</span>(MIRspec_wn) <span class="ot">&lt;-</span> wn</span>
<span id="cb5-19"><a href="FTIR.html#cb5-19" tabindex="-1"></a>MIRspec_wn <span class="ot">&lt;-</span> MIRspec_wn[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>)] <span class="co"># Remove NA values from the 4499  cm-1</span></span>
<span id="cb5-20"><a href="FTIR.html#cb5-20" tabindex="-1"></a></span>
<span id="cb5-21"><a href="FTIR.html#cb5-21" tabindex="-1"></a><span class="co"># 2.1 Remove interference =====================================================</span></span>
<span id="cb5-22"><a href="FTIR.html#cb5-22" tabindex="-1"></a></span>
<span id="cb5-23"><a href="FTIR.html#cb5-23" tabindex="-1"></a>MIRspec_wn <span class="ot">&lt;-</span> MIRspec_wn[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">500</span><span class="sc">:</span><span class="dv">511</span>)] </span></code></pre></div>
</div>
<div id="outlier-values" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Outlier values<a href="FTIR.html#outlier-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Some values of the spectra can also present high interference and therefore should be removed or at least be noticed <span class="citation">(<a href="#ref-ng_search_2018">Ng et al. 2018</a>)</span>. This concerned values over 2 or lower than -2. Here we export the different rows containing values over 2.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="FTIR.html#cb6-1" tabindex="-1"></a><span class="co"># Check max value and remove it</span></span>
<span id="cb6-2"><a href="FTIR.html#cb6-2" tabindex="-1"></a><span class="fu">max</span>(MIRspec_wn)  <span class="co"># Remove value higher than + 2 (Ng et al., 2018; Curran et al., 1996)</span></span>
<span id="cb6-3"><a href="FTIR.html#cb6-3" tabindex="-1"></a>MIRspec_wn_remove_up <span class="ot">&lt;-</span> MIRspec_wn[<span class="fu">apply</span>(MIRspec_wn, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="fu">any</span>(row <span class="sc">&gt;</span> <span class="dv">2</span>)), ] </span>
<span id="cb6-4"><a href="FTIR.html#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="FTIR.html#cb6-5" tabindex="-1"></a><span class="co"># Check lower value and remove it</span></span>
<span id="cb6-6"><a href="FTIR.html#cb6-6" tabindex="-1"></a><span class="fu">min</span>(MIRspec_wn)  <span class="co"># Remove value lower than - 2 (Ng et al., 2018; Curran et al., 1996)</span></span>
<span id="cb6-7"><a href="FTIR.html#cb6-7" tabindex="-1"></a>MIRspec_wn <span class="ot">&lt;-</span> MIRspec_wn[<span class="sc">!</span><span class="fu">rowSums</span>(MIRspec_wn <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>),]</span>
<span id="cb6-8"><a href="FTIR.html#cb6-8" tabindex="-1"></a>MIRspec_wn_remove_low <span class="ot">&lt;-</span> MIRspec_wn[<span class="fu">apply</span>(MIRspec_wn, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="fu">any</span>(row <span class="sc">&lt;</span> <span class="sc">-</span> <span class="dv">2</span>)), ]</span>
<span id="cb6-9"><a href="FTIR.html#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="FTIR.html#cb6-10" tabindex="-1"></a>MIRspec_wn_remove <span class="ot">&lt;-</span> <span class="fu">cbind</span>(MIRspec_wn_remove_low, MIRspec_wn_remove_up)</span>
<span id="cb6-11"><a href="FTIR.html#cb6-11" tabindex="-1"></a><span class="fu">write.table</span>(MIRspec_wn_remove, <span class="st">&quot;./export/Interference_spectra.txt&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">col.names =</span> <span class="cn">TRUE</span>, <span class="at">append =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
</div>
<div id="convert-into-different-spectra-variation" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Convert into different spectra variation<a href="FTIR.html#convert-into-different-spectra-variation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="convert-into-wavelength" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Convert into wavelength<a href="FTIR.html#convert-into-wavelength" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="FTIR.html#cb7-1" tabindex="-1"></a><span class="co"># 03 Convert into different spectra variation ----------------------------------</span></span>
<span id="cb7-2"><a href="FTIR.html#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="FTIR.html#cb7-3" tabindex="-1"></a><span class="co"># 3.1 Convert in Wavelength ####################################################</span></span>
<span id="cb7-4"><a href="FTIR.html#cb7-4" tabindex="-1"></a>MIRspec_wn <span class="ot">&lt;-</span> <span class="fu">anti_join</span>(MIRspec_wn, MIRspec_wn_remove, <span class="at">by =</span> <span class="fu">names</span>(MIRspec_wn))</span>
<span id="cb7-5"><a href="FTIR.html#cb7-5" tabindex="-1"></a>MIRspec_wl <span class="ot">&lt;-</span> MIRspec_wn</span>
<span id="cb7-6"><a href="FTIR.html#cb7-6" tabindex="-1"></a>wn <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="fu">as.numeric</span>(<span class="fu">names</span>(MIRspec_wn))) <span class="sc">*</span> <span class="fl">1e7</span></span>
<span id="cb7-7"><a href="FTIR.html#cb7-7" tabindex="-1"></a>wn <span class="ot">&lt;-</span> <span class="fu">round</span>(wn, <span class="at">digits=</span><span class="dv">0</span>)</span>
<span id="cb7-8"><a href="FTIR.html#cb7-8" tabindex="-1"></a><span class="fu">names</span>(MIRspec_wl) <span class="ot">&lt;-</span> wn </span>
<span id="cb7-9"><a href="FTIR.html#cb7-9" tabindex="-1"></a>MIRspec_wl <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(MIRspec_wl)</span></code></pre></div>
</div>
<div id="spectra-transformations" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Spectra transformations<a href="FTIR.html#spectra-transformations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We converted the MIR data into a total of <strong>14</strong> spectra transformations according to literature review <span class="citation">(<a href="#ref-ludwig_optimised_2023">Ludwig et al. 2023</a>; <a href="#ref-ng_search_2018">Ng et al. 2018</a>)</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="FTIR.html#cb8-1" tabindex="-1"></a><span class="co"># 3.2 Prepare the functions ####################################################</span></span>
<span id="cb8-2"><a href="FTIR.html#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="FTIR.html#cb8-3" tabindex="-1"></a><span class="co"># Remove near zero variable</span></span>
<span id="cb8-4"><a href="FTIR.html#cb8-4" tabindex="-1"></a>remove_nzv <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb8-5"><a href="FTIR.html#cb8-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(x, <span class="at">saveMetrics =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-6"><a href="FTIR.html#cb8-6" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="fu">sum</span>(y<span class="sc">$</span>nzv <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">==</span> <span class="dv">0</span>, x <span class="ot">&lt;-</span> x, x <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="fu">nearZeroVar</span>(x)])</span>
<span id="cb8-7"><a href="FTIR.html#cb8-7" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb8-8"><a href="FTIR.html#cb8-8" tabindex="-1"></a>}       </span>
<span id="cb8-9"><a href="FTIR.html#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="FTIR.html#cb8-10" tabindex="-1"></a><span class="co"># Remove variable with high correlation</span></span>
<span id="cb8-11"><a href="FTIR.html#cb8-11" tabindex="-1"></a>remove_hcd <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb8-12"><a href="FTIR.html#cb8-12" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">findCorrelation</span>(x, <span class="at">cutoff =</span> .<span class="dv">98</span>)</span>
<span id="cb8-13"><a href="FTIR.html#cb8-13" tabindex="-1"></a>  <span class="fu">ifelse</span>(<span class="fu">sum</span>(y) <span class="sc">==</span> <span class="dv">0</span>, x <span class="ot">&lt;-</span> x, x <span class="ot">&lt;-</span> x[,<span class="sc">-</span>y])</span>
<span id="cb8-14"><a href="FTIR.html#cb8-14" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb8-15"><a href="FTIR.html#cb8-15" tabindex="-1"></a>}</span>
<span id="cb8-16"><a href="FTIR.html#cb8-16" tabindex="-1"></a></span>
<span id="cb8-17"><a href="FTIR.html#cb8-17" tabindex="-1"></a><span class="co"># 3.3 Convert in other spectra #################################################</span></span>
<span id="cb8-18"><a href="FTIR.html#cb8-18" tabindex="-1"></a></span>
<span id="cb8-19"><a href="FTIR.html#cb8-19" tabindex="-1"></a>Spectra <span class="ot">&lt;-</span> MIRspec_wn</span>
<span id="cb8-20"><a href="FTIR.html#cb8-20" tabindex="-1"></a><span class="co">#Different transformation of the Spectra according to Ludwig et al. 2023</span></span>
<span id="cb8-21"><a href="FTIR.html#cb8-21" tabindex="-1"></a>IRspectraList_Raw <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;SG 1.5&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">savitzkyGolay</span>(Spectra, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">w =</span> <span class="dv">5</span>)),</span>
<span id="cb8-22"><a href="FTIR.html#cb8-22" tabindex="-1"></a>                          <span class="st">&quot;SG 1.11&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">savitzkyGolay</span>(Spectra, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">w =</span> <span class="dv">11</span>)),</span>
<span id="cb8-23"><a href="FTIR.html#cb8-23" tabindex="-1"></a>                          <span class="st">&quot;SG 1.17&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">savitzkyGolay</span>(Spectra, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">w =</span> <span class="dv">17</span>)),</span>
<span id="cb8-24"><a href="FTIR.html#cb8-24" tabindex="-1"></a>                          <span class="st">&quot;SG 1.23&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">savitzkyGolay</span>(Spectra, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="dv">1</span>, <span class="at">w =</span> <span class="dv">23</span>)),</span>
<span id="cb8-25"><a href="FTIR.html#cb8-25" tabindex="-1"></a>                          <span class="st">&quot;SG 2.5&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">savitzkyGolay</span>(Spectra, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">w =</span> <span class="dv">5</span>)),</span>
<span id="cb8-26"><a href="FTIR.html#cb8-26" tabindex="-1"></a>                          <span class="st">&quot;SG 2.11&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">savitzkyGolay</span>(Spectra, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">w =</span> <span class="dv">11</span>)),</span>
<span id="cb8-27"><a href="FTIR.html#cb8-27" tabindex="-1"></a>                          <span class="st">&quot;SG 2.17&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">savitzkyGolay</span>(Spectra, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">w =</span> <span class="dv">17</span>)),</span>
<span id="cb8-28"><a href="FTIR.html#cb8-28" tabindex="-1"></a>                          <span class="st">&quot;SG 2.23&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">savitzkyGolay</span>(Spectra, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">w =</span> <span class="dv">23</span>)),</span>
<span id="cb8-29"><a href="FTIR.html#cb8-29" tabindex="-1"></a>                          <span class="st">&quot;moving averages 5&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">movav</span>(Spectra, <span class="at">w =</span> <span class="dv">5</span>)),</span>
<span id="cb8-30"><a href="FTIR.html#cb8-30" tabindex="-1"></a>                          <span class="st">&quot;moving averages 11&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">movav</span>(Spectra, <span class="at">w =</span> <span class="dv">11</span>)),</span>
<span id="cb8-31"><a href="FTIR.html#cb8-31" tabindex="-1"></a>                          <span class="st">&quot;moving averages 17&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">movav</span>(Spectra, <span class="at">w =</span> <span class="dv">17</span>)),</span>
<span id="cb8-32"><a href="FTIR.html#cb8-32" tabindex="-1"></a>                          <span class="st">&quot;moving averages 23&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">movav</span>(Spectra, <span class="at">w =</span> <span class="dv">23</span>)),</span>
<span id="cb8-33"><a href="FTIR.html#cb8-33" tabindex="-1"></a>                          <span class="st">&quot;SNV-SG&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">standardNormalVariate</span>(prospectr<span class="sc">::</span><span class="fu">savitzkyGolay</span>(Spectra, <span class="at">m =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">w =</span> <span class="dv">11</span>))), <span class="co">#Best option for machine learning treatment (See Ng et al. 2018)</span></span>
<span id="cb8-34"><a href="FTIR.html#cb8-34" tabindex="-1"></a>                          <span class="st">&quot;continuum removal&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(prospectr<span class="sc">::</span><span class="fu">continuumRemoval</span>(Spectra, <span class="fu">as.numeric</span>(<span class="fu">colnames</span>(Spectra)), <span class="at">type =</span> <span class="st">&quot;R&quot;</span>)))</span>
<span id="cb8-35"><a href="FTIR.html#cb8-35" tabindex="-1"></a></span>
<span id="cb8-36"><a href="FTIR.html#cb8-36" tabindex="-1"></a>IRspectraList <span class="ot">&lt;-</span> IRspectraList_Raw</span>
<span id="cb8-37"><a href="FTIR.html#cb8-37" tabindex="-1"></a></span>
<span id="cb8-38"><a href="FTIR.html#cb8-38" tabindex="-1"></a><span class="co"># Remove the near zero and highly correlated values</span></span>
<span id="cb8-39"><a href="FTIR.html#cb8-39" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(IRspectraList)) {</span>
<span id="cb8-40"><a href="FTIR.html#cb8-40" tabindex="-1"></a>  IRspectraList[[i]] <span class="ot">&lt;-</span> <span class="fu">remove_hcd</span>(IRspectraList[[i]])</span>
<span id="cb8-41"><a href="FTIR.html#cb8-41" tabindex="-1"></a>  IRspectraList[[i]] <span class="ot">&lt;-</span> <span class="fu">remove_nzv</span>(IRspectraList[[i]])</span>
<span id="cb8-42"><a href="FTIR.html#cb8-42" tabindex="-1"></a>}</span>
<span id="cb8-43"><a href="FTIR.html#cb8-43" tabindex="-1"></a></span>
<span id="cb8-44"><a href="FTIR.html#cb8-44" tabindex="-1"></a>IRspectraList <span class="ot">&lt;-</span> <span class="fu">c</span>(IRspectraList, <span class="fu">list</span>(<span class="st">&quot;raw&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Spectra)))</span>
<span id="cb8-45"><a href="FTIR.html#cb8-45" tabindex="-1"></a></span>
<span id="cb8-46"><a href="FTIR.html#cb8-46" tabindex="-1"></a><span class="co"># 3.4 Export all the spectra ###################################################</span></span>
<span id="cb8-47"><a href="FTIR.html#cb8-47" tabindex="-1"></a></span>
<span id="cb8-48"><a href="FTIR.html#cb8-48" tabindex="-1"></a><span class="co">#Export csv of files</span></span>
<span id="cb8-49"><a href="FTIR.html#cb8-49" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">names</span>(IRspectraList)) {</span>
<span id="cb8-50"><a href="FTIR.html#cb8-50" tabindex="-1"></a>  <span class="fu">write.table</span>(IRspectraList[i], <span class="at">file =</span> <span class="fu">paste0</span>(<span class="st">&quot;./export/spectra/Full_spectra_&quot;</span>,<span class="fu">names</span>(IRspectraList[i]),<span class="st">&quot;.txt&quot;</span>), <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">col.names =</span> <span class="cn">TRUE</span>, <span class="at">append =</span> <span class="cn">FALSE</span>, <span class="at">fileEncoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb8-51"><a href="FTIR.html#cb8-51" tabindex="-1"></a>}</span>
<span id="cb8-52"><a href="FTIR.html#cb8-52" tabindex="-1"></a></span>
<span id="cb8-53"><a href="FTIR.html#cb8-53" tabindex="-1"></a><span class="fu">write.table</span>(MIRspec_wn, <span class="st">&quot;./export/spectra/Spectra_Wavenumber.txt&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">col.names =</span> <span class="cn">TRUE</span>, <span class="at">append =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-54"><a href="FTIR.html#cb8-54" tabindex="-1"></a><span class="fu">write.table</span>(MIRspec_wl, <span class="st">&quot;./export/spectra/Spectra_Wavelength.txt&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>, <span class="at">col.names =</span> <span class="cn">TRUE</span>, <span class="at">append =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
</div>
<div id="plot-the-spectra" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Plot the spectra<a href="FTIR.html#plot-the-spectra" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-spectra-in-absorbance" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> The spectra in absorbance<a href="FTIR.html#the-spectra-in-absorbance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="FTIR.html#cb9-1" tabindex="-1"></a><span class="co"># 04 Plot the Spectrum of the spectra ------------------------------------------</span></span>
<span id="cb9-2"><a href="FTIR.html#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="FTIR.html#cb9-3" tabindex="-1"></a><span class="co"># 4.1 Plot the absorbance ######################################################</span></span>
<span id="cb9-4"><a href="FTIR.html#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="FTIR.html#cb9-5" tabindex="-1"></a>IRSpectra <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">row.names</span>(MIRspec_wl))</span>
<span id="cb9-6"><a href="FTIR.html#cb9-6" tabindex="-1"></a>IRSpectra<span class="sc">$</span>wn <span class="ot">&lt;-</span> MIRspec_wn</span>
<span id="cb9-7"><a href="FTIR.html#cb9-7" tabindex="-1"></a>IRSpectra<span class="sc">$</span>wnA<span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>MIRspec_wn) <span class="co"># Convert to wave number absorbance</span></span>
<span id="cb9-8"><a href="FTIR.html#cb9-8" tabindex="-1"></a>IRSpectra<span class="sc">$</span>wl <span class="ot">&lt;-</span> MIRspec_wl</span>
<span id="cb9-9"><a href="FTIR.html#cb9-9" tabindex="-1"></a>IRSpectra<span class="sc">$</span>wlA <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>MIRspec_wl) <span class="co"># Convert to wavelength absorbance</span></span>
<span id="cb9-10"><a href="FTIR.html#cb9-10" tabindex="-1"></a><span class="fu">rownames</span>(IRSpectra) <span class="ot">&lt;-</span> IRSpectra<span class="sc">$</span><span class="st">`</span><span class="at">row.names(MIRspec_wl)</span><span class="st">`</span></span>
<span id="cb9-11"><a href="FTIR.html#cb9-11" tabindex="-1"></a></span>
<span id="cb9-12"><a href="FTIR.html#cb9-12" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;Soil spectra in wavenumbers absorbance.png&quot;</span>, <span class="at">width =</span> <span class="dv">297</span>, <span class="at">height =</span> <span class="dv">210</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb9-13"><a href="FTIR.html#cb9-13" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;Soil spectra in wavenumbers absorbance.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">10</span><span class="sc">*</span><span class="dv">2</span>, <span class="at">height =</span> <span class="dv">6</span><span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb9-14"><a href="FTIR.html#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="FTIR.html#cb9-15" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x =</span> <span class="fu">colnames</span>(IRSpectra<span class="sc">$</span>wn), <span class="at">y =</span> <span class="fu">t</span>(IRSpectra<span class="sc">$</span>wnA),</span>
<span id="cb9-16"><a href="FTIR.html#cb9-16" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Wavenumber &quot;</span>, <span class="st">&quot;(cm&quot;</span><span class="sc">^</span><span class="st">&quot;-1&quot;</span>, <span class="st">&quot;)&quot;</span>)),</span>
<span id="cb9-17"><a href="FTIR.html#cb9-17" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Absorbance&quot;</span>,</span>
<span id="cb9-18"><a href="FTIR.html#cb9-18" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,   <span class="co">#&quot;l&quot; = ligne</span></span>
<span id="cb9-19"><a href="FTIR.html#cb9-19" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb9-20"><a href="FTIR.html#cb9-20" tabindex="-1"></a>        <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(IRSpectra<span class="sc">$</span>wn))</span>
<span id="cb9-21"><a href="FTIR.html#cb9-21" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb9-22"><a href="FTIR.html#cb9-22" tabindex="-1"></a></span>
<span id="cb9-23"><a href="FTIR.html#cb9-23" tabindex="-1"></a></span>
<span id="cb9-24"><a href="FTIR.html#cb9-24" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;Soil spectra in wavelength absorbance.png&quot;</span>, <span class="at">width =</span> <span class="dv">297</span>, <span class="at">height =</span> <span class="dv">210</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb9-25"><a href="FTIR.html#cb9-25" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;Soil spectra in wavelength absorbance.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">10</span><span class="sc">*</span><span class="dv">2</span>, <span class="at">height =</span> <span class="dv">6</span><span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb9-26"><a href="FTIR.html#cb9-26" tabindex="-1"></a></span>
<span id="cb9-27"><a href="FTIR.html#cb9-27" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x =</span> <span class="fu">colnames</span>(IRSpectra<span class="sc">$</span>wl), <span class="at">y =</span> <span class="fu">t</span>(IRSpectra<span class="sc">$</span>wlA),</span>
<span id="cb9-28"><a href="FTIR.html#cb9-28" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Wavelength /nm &quot;</span>,</span>
<span id="cb9-29"><a href="FTIR.html#cb9-29" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Absorbance&quot;</span>,</span>
<span id="cb9-30"><a href="FTIR.html#cb9-30" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,   <span class="co">#&quot;l&quot; = ligne</span></span>
<span id="cb9-31"><a href="FTIR.html#cb9-31" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb9-32"><a href="FTIR.html#cb9-32" tabindex="-1"></a>        <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(IRSpectra<span class="sc">$</span>wl))</span>
<span id="cb9-33"><a href="FTIR.html#cb9-33" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="main-files/figure-html/plot%20wawenumber%20abso-1.png" width="672" /></p>
<p><img src="main-files/figure-html/plot%20wawelength%20abso-1.png" width="672" /></p>
</div>
<div id="the-spectra-in-reflectance" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> The spectra in reflectance<a href="FTIR.html#the-spectra-in-reflectance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="FTIR.html#cb10-1" tabindex="-1"></a><span class="co"># 4.2 Plot the reflectance #####################################################</span></span>
<span id="cb10-2"><a href="FTIR.html#cb10-2" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;Soil spectra in wavenumbers reflectance.png&quot;</span>, <span class="at">width =</span> <span class="dv">297</span>, <span class="at">height =</span> <span class="dv">210</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb10-3"><a href="FTIR.html#cb10-3" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;Soil spectra in wavenumbers reflectance.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">10</span><span class="sc">*</span><span class="dv">2</span>, <span class="at">height =</span> <span class="dv">6</span><span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb10-4"><a href="FTIR.html#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="FTIR.html#cb10-5" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x =</span> <span class="fu">colnames</span>(IRSpectra<span class="sc">$</span>wn), <span class="at">y =</span> <span class="fu">t</span>(IRSpectra<span class="sc">$</span>wn),</span>
<span id="cb10-6"><a href="FTIR.html#cb10-6" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Wavenumber &quot;</span>, <span class="st">&quot;(cm&quot;</span><span class="sc">^</span><span class="st">&quot;-1&quot;</span>, <span class="st">&quot;)&quot;</span>)),</span>
<span id="cb10-7"><a href="FTIR.html#cb10-7" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Reflectance&quot;</span>,</span>
<span id="cb10-8"><a href="FTIR.html#cb10-8" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,   <span class="co">#&quot;l&quot; = ligne</span></span>
<span id="cb10-9"><a href="FTIR.html#cb10-9" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb10-10"><a href="FTIR.html#cb10-10" tabindex="-1"></a>        <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(IRSpectra<span class="sc">$</span>wn))</span>
<span id="cb10-11"><a href="FTIR.html#cb10-11" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb10-12"><a href="FTIR.html#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="FTIR.html#cb10-13" tabindex="-1"></a></span>
<span id="cb10-14"><a href="FTIR.html#cb10-14" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;Soil spectra in wavelength reflectance.png&quot;</span>, <span class="at">width =</span> <span class="dv">297</span>, <span class="at">height =</span> <span class="dv">210</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb10-15"><a href="FTIR.html#cb10-15" tabindex="-1"></a><span class="fu">pdf</span>(<span class="st">&quot;Soil spectra in wavelength reflectance.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">10</span><span class="sc">*</span><span class="dv">2</span>, <span class="at">height =</span> <span class="dv">6</span><span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb10-16"><a href="FTIR.html#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="FTIR.html#cb10-17" tabindex="-1"></a><span class="fu">matplot</span>(<span class="at">x =</span> <span class="fu">colnames</span>(IRSpectra<span class="sc">$</span>wl), <span class="at">y =</span> <span class="fu">t</span>(IRSpectra<span class="sc">$</span>wl),</span>
<span id="cb10-18"><a href="FTIR.html#cb10-18" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;Wavelength /nm &quot;</span>,</span>
<span id="cb10-19"><a href="FTIR.html#cb10-19" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Reflectance&quot;</span>,</span>
<span id="cb10-20"><a href="FTIR.html#cb10-20" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,   <span class="co">#&quot;l&quot; = ligne</span></span>
<span id="cb10-21"><a href="FTIR.html#cb10-21" tabindex="-1"></a>        <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb10-22"><a href="FTIR.html#cb10-22" tabindex="-1"></a>        <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(IRSpectra<span class="sc">$</span>wl))</span>
<span id="cb10-23"><a href="FTIR.html#cb10-23" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="main-files/figure-html/plot%20wavenumber%20reflect-1.png" width="672" /></p>
<p><img src="main-files/figure-html/plot%20wavelength%20reflect-1.png" width="672" /></p>
</div>
</div>
<div id="kennard-stone-sampling" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Kennard Stone sampling<a href="FTIR.html#kennard-stone-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Kennard stone sampling is used to select a wide range of a population that will represent the diversity of the individuals <span class="citation">(<a href="#ref-kennard_computer_1969">Kennard and Stone 1969</a>)</span>. This sampling strategy has proven to be efficient in the soils spectrometry context <span class="citation">(<a href="#ref-ramirez-lopez_sampling_2014">Ramirez-Lopez et al. 2014</a>)</span>.
We selected different numbers of samples for each depth increment with an over-representation of the topsoil (0 - 10 cm). All the samples from 2017 - 2018 were analysed, so no sampling strategy has been applied to them.</p>
<table>
<caption>(#tab:sampling table)Ratio of C factor between different land uses.</caption>
<thead>
<tr class="header">
<th align="center">Depth (cm)</th>
<th align="center">Year</th>
<th align="center">Number</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0 - 10</td>
<td align="center">2022</td>
<td align="center">30</td>
</tr>
<tr class="even">
<td align="center">10 - 30</td>
<td align="center">2022</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">30 - 50</td>
<td align="center">2022</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">50 - 70</td>
<td align="center">2022</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">70 - 100</td>
<td align="center">2022</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">0 - 10</td>
<td align="center">2023</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="center">10 - 30</td>
<td align="center">2023</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">30 - 50</td>
<td align="center">2023</td>
<td align="center">6</td>
</tr>
<tr class="odd">
<td align="center">50 - 70</td>
<td align="center">2023</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">70 - 100</td>
<td align="center">2023</td>
<td align="center">3</td>
</tr>
</tbody>
</table>
<p>In the selection of samples, you can choose the year and depth increment. Here, we show a selection for the 2022 campaign at 0 - 10 cm depth. The table <em>Samples_info</em> use the information collected during the <a href="Field.html#Field">field campaign</a> and the <em>Field_observations</em> file. The different entries are:</p>
<ul>
<li><strong>Lab_ID</strong> Laboratory number gave at the samples when enter into TÃ¼bingen Soil Science and Geomrophology laboratory inventory.</li>
<li><strong>Site_name</strong> the site’s name according to the CLHS sampling.</li>
<li><strong>Depth_cm</strong> depth increment of the sampling (0 - 10 - 30 - 50 - 70 - 100 cm).</li>
<li><strong>X_WGS84</strong> longitude in WGS84 (epsg:4326), measured from <em>Garmin, GPSMAP 60Cx</em> with ± 10 - 3 m accuracy (depending of satellite coverage).</li>
<li><strong>Y_WGS84</strong> latitude in WGS84 (epsg:4326), measured from <em>Garmin, GPSMAP 60Cx</em> with ± 10 - 3 m accuracy (depending of satellite coverage).</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="FTIR.html#cb11-1" tabindex="-1"></a><span class="co"># 05 Kennard Stone sampling ----------------------------------------------------</span></span>
<span id="cb11-2"><a href="FTIR.html#cb11-2" tabindex="-1"></a><span class="co"># 5.1 Select the samples #######################################################</span></span>
<span id="cb11-3"><a href="FTIR.html#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="FTIR.html#cb11-4" tabindex="-1"></a>Samples_info <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;./data/Samples_info.csv&quot;</span>, <span class="at">delim =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb11-5"><a href="FTIR.html#cb11-5" tabindex="-1"></a>selection <span class="ot">&lt;-</span> Samples_info[Samples_info<span class="sc">$</span>Depth_cm <span class="sc">==</span> <span class="st">&quot;0_10&quot;</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(<span class="st">&quot;B07_2022&quot;</span>, Samples_info<span class="sc">$</span>Site_name), ] <span class="co"># You can select the year and the depth</span></span>
<span id="cb11-6"><a href="FTIR.html#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="FTIR.html#cb11-7" tabindex="-1"></a><span class="co"># Select the samples to analyse</span></span>
<span id="cb11-8"><a href="FTIR.html#cb11-8" tabindex="-1"></a>MIRsample <span class="ot">&lt;-</span> MIRspec_wl[<span class="fu">rownames</span>(MIRspec_wl) <span class="sc">%in%</span> selection<span class="sc">$</span>Lab_ID,]</span>
<span id="cb11-9"><a href="FTIR.html#cb11-9" tabindex="-1"></a></span>
<span id="cb11-10"><a href="FTIR.html#cb11-10" tabindex="-1"></a><span class="co"># 5.2 Run the sampling #########################################################</span></span>
<span id="cb11-11"><a href="FTIR.html#cb11-11" tabindex="-1"></a>sample <span class="ot">&lt;-</span> <span class="fu">kenStone</span>(MIRsample, <span class="at">k =</span> <span class="dv">30</span>, <span class="at">metric =</span> <span class="st">&quot;euclid&quot;</span>) <span class="co"># Make samples with Kennard Stone in euclidian distance</span></span>
<span id="cb11-12"><a href="FTIR.html#cb11-12" tabindex="-1"></a></span>
<span id="cb11-13"><a href="FTIR.html#cb11-13" tabindex="-1"></a>MIRsample <span class="ot">&lt;-</span> MIRsample[sample<span class="sc">$</span>model,]</span>
<span id="cb11-14"><a href="FTIR.html#cb11-14" tabindex="-1"></a>MIRsample <span class="ot">&lt;-</span> <span class="fu">row.names</span>(MIRsample)</span>
<span id="cb11-15"><a href="FTIR.html#cb11-15" tabindex="-1"></a><span class="fu">write.table</span>(MIRsample, <span class="st">&quot;./export/samples/B07_2022 Samples 0 - 10 cm.txt&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>, <span class="at">append =</span> <span class="cn">FALSE</span>)</span></code></pre></div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bahrami_studying_2022" class="csl-entry">
Bahrami, Amir, Majid Danesh, and Mehdi Bahrami. 2022. <span>“Studying Sand Component of Soil Texture Using the Spectroscopic Method.”</span> <em>Infrared Physics &amp; Technology</em> 122 (May): 104056. <a href="https://doi.org/10.1016/j.infrared.2022.104056">https://doi.org/10.1016/j.infrared.2022.104056</a>.
</div>
<div id="ref-ge_primer_2022" class="csl-entry">
Ge, Y., Alexandre M. J.-C. Wadoux, and Y Peng. 2022. <em>A Primer on Soil Analysis Using Visible and Near-Infrared (Vis-<span>NIR</span>) and Mid-Infrared (<span>MIR</span>) Spectroscopy</em>. FAO.
</div>
<div id="ref-kennard_computer_1969" class="csl-entry">
Kennard, R. W., and L. A. Stone. 1969. <span>“Computer <span>Aided</span> <span>Design</span> of <span>Experiments</span>.”</span> <em>Technometrics</em> 11 (1): 137–48. <a href="https://doi.org/10.2307/1266770">https://doi.org/10.2307/1266770</a>.
</div>
<div id="ref-ludwig_optimised_2023" class="csl-entry">
Ludwig, Bernard, Isabel Greenberg, Michael Vohland, and Kerstin Michel. 2023. <span>“Optimised Use of Data Fusion and Memory‐based Learning with an <span>Austrian</span> Soil Library for Predictions with Infrared Data.”</span> <em>European Journal of Soil Science</em> 74 (4): e13394. <a href="https://doi.org/10.1111/ejss.13394">https://doi.org/10.1111/ejss.13394</a>.
</div>
<div id="ref-ng_near_2022" class="csl-entry">
Ng, Wartini, Brendan Malone, Budiman Minasny, and Sangho Jeon. 2022. <span>“Near and Mid Infrared Soil Spectroscopy.”</span> In <em>Reference <span>Module</span> in <span>Earth</span> <span>Systems</span> and <span>Environmental</span> <span>Sciences</span></em>, B9780128229743000227. Elsevier. <a href="https://doi.org/10.1016/B978-0-12-822974-3.00022-7">https://doi.org/10.1016/B978-0-12-822974-3.00022-7</a>.
</div>
<div id="ref-ng_search_2018" class="csl-entry">
Ng, Wartini, Budiman Minasny, Brendan Malone, and Patrick Filippi. 2018. <span>“In Search of an Optimum Sampling Algorithm for Prediction of Soil Properties from Infrared Spectra.”</span> <em>PeerJ</em> 6 (October): e5722. <a href="https://doi.org/10.7717/peerj.5722">https://doi.org/10.7717/peerj.5722</a>.
</div>
<div id="ref-ramirez-lopez_sampling_2014" class="csl-entry">
Ramirez-Lopez, Leonardo, Karsten Schmidt, Thorsten Behrens, Bas van Wesemael, Jose A. M. Demattê, and Thomas Scholten. 2014. <span>“Sampling Optimal Calibration Sets in Soil Infrared Spectroscopy.”</span> <em>Geoderma</em> 226-227 (August): 140–50. <a href="https://doi.org/10.1016/j.geoderma.2014.02.002">https://doi.org/10.1016/j.geoderma.2014.02.002</a>.
</div>
<div id="ref-stenberg_visible_2010" class="csl-entry">
Stenberg, Bo, Raphael A. Viscarra Rossel, Abdul Mounem Mouazen, and Johanna Wetterlind. 2010. <span>“Visible and <span>Near</span> <span>Infrared</span> <span>Spectroscopy</span> in <span>Soil</span> <span>Science</span>.”</span> In <em>Advances in <span>Agronomy</span></em>, 107:163–215. Elsevier. <a href="https://doi.org/10.1016/S0065-2113(10)07005-7">https://doi.org/10.1016/S0065-2113(10)07005-7</a>.
</div>
<div id="ref-viscarra_rossel_global_2016" class="csl-entry">
Viscarra Rossel, R. A., T. Behrens, E. Ben-Dor, D. J. Brown, J. A. M. Demattê, K. D. Shepherd, Z. Shi, et al. 2016. <span>“A Global Spectral Library to Characterize the World’s Soil.”</span> <em>Earth-Science Reviews</em> 155 (April): 198–230. <a href="https://doi.org/10.1016/j.earscirev.2016.01.012">https://doi.org/10.1016/j.earscirev.2016.01.012</a>.
</div>
<div id="ref-wadoux_soil_2021" class="csl-entry">
Wadoux, Alexandre M. J.-C., Brendan Malone, Budiman Minasny, Mario Fajardo, and Alex B. McBratney. 2021. <em>Soil Spectral Inference with <span>R</span> Analysing Digital Soil Spectra</em>. S.l.: SPRINGER NATURE. <a href="http://search.ebscohost.com/login.aspx?direct=true&amp;scope=site&amp;db=nlebk&amp;db=nlabk&amp;AN=2760028">http://search.ebscohost.com/login.aspx?direct=true&amp;scope=site&amp;db=nlebk&amp;db=nlabk&amp;AN=2760028</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Field.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="laboratory-measurement-of-the-selected-soil-samples.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null,
"fuse": {
"threshold": 0.4
}
},
"toc": {
"collapse": "subsection"
},
"fig_path": "computed-figures/"
});
});
</script>

</body>

</html>
